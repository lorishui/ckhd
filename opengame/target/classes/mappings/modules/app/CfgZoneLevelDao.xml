<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.ckhd.opengame.app.dao.CfgZoneLevelDao">
	<sql id="CfgZoneLevelColumns">
		a.id,
		a.ckappid,
		a.channelid,
		a.sort,
		a.create_by AS "createBy.id",
		a.create_date,
		a.update_by AS "updateBy.id",
		a.update_date,
		a.del_flag,
		a.remarks
	</sql>

	<select id="get" resultType="CfgZoneLevel">
		SELECT
		a.id,
		a.biztype,
		a.redzonelist,
		a.yellowzonelist
		FROM cfg_zone_level a
		WHERE a.id = #{id} and a.del_flag='0'
	</select>
	
	<insert id="insert">
		INSERT INTO cfg_zone_level(
		id,
		ckappid,
		channelid,
		biztype,
		sort,
		del_flag,
		create_by,
		create_date,
		update_by,
		update_date,
		remarks
		) VALUES (
		#{id},
		#{ckappid},
		#{channelid},
		#{biztype},
		#{sort},
		#{delFlag},
		#{createBy.id},
		#{createDate},
		#{updateBy.id},
		#{updateDate},
		#{remarks}
		)
	</insert>

	<select id="checkExist" resultType="int">
		select count(0) from cfg_zone_level where ckappid=#{ckappid} and channelid=#{channelid} and biztype=#{biztype}
	</select>
	
	<update id="updateRedzone">
		UPDATE cfg_zone_level SET
		redzonelist = #{redzonelist}
		WHERE id = #{id}
	</update>
	<update id="updateYellowzone">
		UPDATE cfg_zone_level SET
		yellowzonelist = #{yellowzonelist}
		WHERE id = #{id}
	</update>
	
	<select id="findList" resultType="CfgZoneLevel">
		select id,
		ckappid,
		channelid,
		biztype,
		sort from cfg_zone_level where del_flag='0'
		<if test="ckappid != null and ckappid != ''">
		and (ckappid = #{ckappid} or ckappid='#')
		</if>
		<if test="channelid != null and channelid != ''">
		and (channelid = #{channelid} or channelid='#')
		</if>
		<if test="biztype != null and biztype != ''">
		and biztype = #{biztype}
		</if>
		ORDER BY sort
	</select>

	<select id="findCfg" resultType="CfgZoneLevel">
		SELECT
		*
		FROM cfg_zone_level
		WHERE (ckappid = #{ckappid} or ckappid='#') and (channelid = #{channelid} or channelid = '#') and biztype=#{biztype} and del_flag='0'
		order by ckappid desc,channelid desc;
	</select>
	
</mapper>