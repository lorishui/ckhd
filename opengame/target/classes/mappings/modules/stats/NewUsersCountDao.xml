<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.ckhd.opengame.stats.dao.NewUsersCountDao">
	<select id="statNew" resultType="NewUsersCount">
		select 
		DATE_FORMAT(CONCAT(a.`timeframe`,'0000'),'${timeFt}') AS timeframes,
		SUM(newNum) as newNum
		from count_new_users a 
		where a.timeframe>='${startTime}00' and a.timeframe<![CDATA[<=]]>'${endTime}23'
		<if test="ckAppId != null and ckAppId != ''">
			and ckAppId = #{ckAppId}
		</if>
		<if test="ckChannelId != null and ckChannelId != ''">
			and ckChannelId = #{ckChannelId}
		</if>
		group by timeframes
	</select>
	
	<select id="statAct" resultType="NewUsersCount">
		select 
		DATE_FORMAT(CONCAT(a.`timeframe`,'0000'),'${timeFt}') AS timeframes,
		SUM(actNum) as actNum
		from count_act_users a 
		where a.timeframe>='${startTime}00' and a.timeframe<![CDATA[<=]]>'${endTime}23'
		<if test="ckAppId != null and ckAppId != ''">
			and ckAppId = #{ckAppId}
		</if>
		<if test="ckChannelId != null and ckChannelId != ''">
			and ckChannelId = #{ckChannelId}
		</if>
		group by timeframes
	</select>
	
</mapper>