<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.ckhd.opengame.online.dao.OfflinePayDao">
	
	<!-- 插入数据-->
	<insert id="insert">
		INSERT INTO app_offline_pay(
		id,
		ckChannelId,
		ckAppId,
		mmAppId,
		imsi,
		imei,
		iccid,
		androidId,
		versionName,
		payType,
		errMsg,
		prices,
		appPayContent,
		times,
		period,
		status,
		create_date
		) VALUES (
		#{id},
		#{ckChannelId},
		#{ckAppId},
		#{mmAppId},
		#{imsi},
		#{imei},
		#{iccid},
		#{androidId},
		#{versionName},
		#{payType},
		#{errMsg},
		#{prices},
		#{appPayContent},
		#{times},
		#{period},
		#{status},
		#{createDate}
		)
	</insert>
	
	<!-- 获取imsi的支付次数 -->
	<select id="getCountByImsiAndTime" resultType="java.lang.Integer">
		SELECT COUNT(0) num FROM app_offline_pay a 
		WHERE  a.`ckAppId`=#{ckAppId} 
		AND a.`imsi`=#{imsi}
		AND a.`payType`=#{payType}
		AND a.ckChannelId=#{ckChannelId}
		and a.status=0
		and a.create_date >= #{startTime} 
		and a.create_date <![CDATA[ <= ]]> #{endTime}
	</select>
	
	<!-- 获取iccid的支付次数 -->
	<select id="getCountByIccidAndTime" resultType="java.lang.Integer">
		SELECT COUNT(0) num FROM app_offline_pay a 
		WHERE  a.`ckAppId`=#{ckAppId} 
		AND a.`iccid`=#{iccid}
		AND a.`payType`=#{payType}
		AND a.ckChannelId=#{ckChannelId}
		and a.status=0
		and a.create_date >= #{startTime} 
		and a.create_date <![CDATA[ <= ]]> #{endTime}
	</select>
</mapper>