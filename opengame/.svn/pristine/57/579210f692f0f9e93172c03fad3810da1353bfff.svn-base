<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.ckhd.opengame.mmapi.dao.MmAppOrderDao">

	<insert id="insert">
		INSERT INTO mm_app_order(
		id,
		ckapp_id,
		transaction_id,
		msg_type,
		version,
		send_device_type,
		send_device_id,
		dest_device_type,
		dest_device_id,
		order_id,
		trade_id,
		check_id,
		price,
		action_time,
		action_id,
		msisdn,
		fee_msisdn,
		app_id,
		program_id,
		paycode,
		total_price,
		subs_number,
		subs_seq,
		channel_id,
		extend_data,
		order_type,
		order_payment,
		province_id,
		MD5sign,
		returnStatus,
		create_date,
		create_by,
		remarks,
		random
		) VALUES (
		#{id},
		(select ckapp_id from app_carriers where app_id=#{appId} and carriers_type='MM' limit 0,1),
		#{transactionId},
		#{msgType},
		#{version},
		#{sendDeviceType},
		#{sendDeviceId},
		#{destDeviceType},
		#{destDeviceId},
		#{orderId},
		#{tradeId},
		#{checkId},
		#{price},
		#{actionTime},
		#{actionId},
		#{msisdn},
		#{feeMsisdn},
		#{appId},
		#{programId},
		#{paycode},
		#{totalPrice},
		#{subsNumber},
		#{subsSeq},
		#{channelId},
		#{extendData},
		#{orderType},
		#{orderPayment},
		#{provinceID},
		#{MD5sign},
		#{returnStatus},
		#{createDate},
		#{createBy},
		#{remarks},
		#{random}
		)
	</insert>
	
	
	
	<!-- 根据业务单号查询MmAppOrder -->
	<select id="countByTransactionId" parameterType="MmAppOrder" resultType="long">
		SELECT
			count(1) as number
		FROM  mm_app_order
		WHERE app_id=#{appId} and fee_msisdn=#{feeMsisdn} and paycode=#{paycode} and action_time=#{actionTime}
	</select>
	

</mapper>