<%@ page contentType="text/html;charset=UTF-8" %>
<%@ include file="/WEB-INF/views/include/taglib.jsp"%>
<html>
<head>
<title>新增图形展示</title>
<meta name="decorator" content="default"/>
<script type="text/javascript" src="/static/echarts/echarts.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
	$("#searchForm").validate({
		submitHandler: function(form){
			//loading('正在提交，请稍等...');
			
			form.submit();
		},
		errorContainer: "#messageBox"
	});
	$("#channelId").change(function(){
		var channelId = $('#channelId option:selected').val();
		getCarriersChannelId(channelId);
	});
	var channelId = '${newUserCount.ckChannelId}';
	if(channelId != ''){
		getCarriersChannelId(channelId);
	}
});

function getCarriersChannelId(channelId){
	var carriersChannelId = $("#carriersChannelId");
	carriersChannelId.html("");
	 if(channelId != ''){
		$.ajax({ 
			url: "${ctx }/app/channelcarriers/getList?carriersType=MM&channelId="+channelId, success: function(data){
				var code = "<option value=''>全部</option>";
				for(var i=0;i<data.length;i++){
					 code+='<option value="'+data[i].id+'" >'+data[i].name+'('+data[i].id+')</option>'; 
				}
				carriersChannelId.append(code);
			}
		});
	}
}
</script>
<style type="text/css">
body{ 
	background-color:#f5f5f5;
}
.position{
	padding-top:5px;
	padding-left:15px;
	width:800px;
	height:25px;
	background-color: #ffffff;
	/* margin-left:25px; */
	/* box-shadow: 0px 1px 3px rgba(34, 25, 25, 0.2); */
	/* -moz-border-radius: 15px;
    -webkit-border-radius: 15px;
    border-radius: 8px 8px 0px 0px; */
    
}
.button{
	/* margin-left:25px; */
	padding: 5px 5px 5px 5px;
}
.graph{
	margin-left: 25px;
	width: 815px;
	height: 490px;
	border: 1;
	border-color: #0d0d0d;
	border-style: solid;
	border-radius: 8px 8px 0px 0px;
	
}
.button{
	padding: 5px 5px 5px 5px;
	width: 80px;
	margin-left: 20px;
	margin-top: 20px;
}
.check{
	background-color: #6fa8dc;
	
}
.button:hover {
    background: #f47c20;
}
</style>
</head>
<body> 
	<form:form id="searchForm"  modelAttribute="newUsersCount" action="${ctx}/newUserCount/graphAct" method="post" class="breadcrumb form-search">
		<div>
			<label>游戏：</label>
			<form:select id="ckappId" path="ckAppId" class="input-medium" >
				<form:option value="" label="(全部)"/>
				<form:options items="${fns:getAPPCkList()}" itemLabel="name" itemValue="ckappId" htmlEscape="false"/>
		    </form:select>
		    <label>渠道：</label>
			<form:select id="channelId" path="ckChannelId" class="input-medium">
				<form:option value="" label="(全部)"/>
				<form:options items="${fns:getChannelList()}" itemLabel="name" itemValue="id" htmlEscape="false"/>
		    </form:select>
		</div>
		<br/>
		<div>
			<label>时间：</label>
			<span><font color="red">*</font> </span>
			<input id="startTime" name="startTime" type="text" readonly="readonly" maxlength="20" class="WdateTime required"
				value="${newUsersCount.startTime}" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',isShowClear:false});"/>到
			<input id="endTime" name="endTime" type="text" readonly="readonly" maxlength="20" class="WdateTime required"
				value="${newUsersCount.endTime}" onclick="WdatePicker({dateFmt:'yyyy-MM-dd',isShowClear:false});"/>
		</div>
		<br/>
		<div>
			<label>统计时间精度选择：</label>
			<%-- <input type="radio" name="timeType" value="1" ${newUserCount.timeType == 1 or newUserCount.timeType == 0?'checked="checked"':'' }>月 --%>
			<input type="radio" name="timeType" value="2" ${newUsersCount.timeType == 2 ?'checked="checked"':'' }>日
			<input type="radio" name="timeType" value="3" ${newUsersCount.timeType == 3 ?'checked="checked"':''}>时
			&nbsp;&nbsp;&nbsp;<input id="btnSubmit" class="btn btn-primary" type="submit" value="查询"/>&nbsp;&nbsp;
		</div>
	</form:form>
	
	<div class="graph">
		<div class="position"><font size="3">用户新增统计</font></div>
	   <%--  <div class="bottom">
	    	<button value="新增用户" onclick="clickSuccess(this);" class="button${newUserCount.dataType eq 0 or newUserCount.dataType eq 1?' check':'' }">新增用户<br/>
	    </div> --%>
	    <!-- 为 ECharts 准备一个具备大小（宽高）的 DOM -->
	    <div id="main" style="width:800px;height:400px;background-color: #f5f5f5;"></div>
	</div>
	    <script type="text/javascript">
	        // 基于准备好的dom，初始化echarts实例
	        var myChart = echarts.init(document.getElementById('main'));
	        var legend_data = ${legend_data};
	        var xAxis_data = ${xAxis_data};
	        var sercies = ${sercies};
	        // 指定图表的配置项和数据
	        var option = {
	           /*  title: {
	            	show:true,
	            	textAlign:'left',
	                text: '${title}'
	            }, */
	            tooltip:{
	                trigger: 'axis'
	            },
	            legend:{
	            	orient:'horizontal',
	            	align:'left',
	            	itemGap:20,
	                data: legend_data
	            },
	            toolbox: {
	            	orient:'vertical',
	                // y: 'bottom',
	                feature: {
	                    magicType: {
	                        type: ['bar', 'line']
	                    },
	                    dataView: {},
	                    saveAsImage: {
	                        pixelRatio: 2
	                    }
	                }
	            },
	            xAxis: {
	                data: xAxis_data
	            },
	            yAxis: {},
	            backgroundColor:'#f5f5f5',
	            series: sercies
	        };
	        // 使用刚指定的配置项和数据显示图表。
	        myChart.setOption(option);
	    </script>
</body>
</html>